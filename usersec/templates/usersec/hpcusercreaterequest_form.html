{% extends 'base.html' %}

{% load crispy_forms_tags %}

{% block content %}

  <h2 class="mt-5">
    {% if update %}
      Update User Invitation
    {% else %}
      Invite User
    {% endif %}
  </h2>

  <p class="lead">
    You can invite users with a Charite and MDC account to your group.
    The user has to accept the invitation and then HPC administration will approve the request.
    Users only can be member of one group.
    If a user should collaborate with another group, request an additional project and invite all relevant members to that project.
  </p>

  {% include "usersec/modules/comments.html" %}

  <form method="post" id="submit" data-is-admin="{{ admin }}">
    {% csrf_token %}
    {% if admin %}
      <dl class="row">
        <dt class="col-sm-3">Resource Quotas</dt>
        <dd class="col-sm-9">
          <dl class="row">
            {% for key, value in object.resources_requested.items %}
              <dt class="col-sm-3 text-muted">{{ key }}</dt>
              <dd class="col-sm-9">{{ value }}</dd>
            {% endfor %}
          </dl>
        </dd>

        <dt class="col-sm-3">Requester</dt>
        <dd class="col-sm-9">{{ object.requester.username }}</dd>

        <dt class="col-sm-3">Description</dt>
        <dd class="col-sm-9">{{ object.description }}</dd>

        <dt class="col-sm-3">Expiration</dt>
        <dd class="col-sm-9">{{ object.expiration|date:"Y-m-d" }}</dd>
      </dl>
    {% endif %}

    {% for field in form.hidden_fields %}
      {{ field }}
    {% endfor %}

    {% include "usersec/form_field.html" with field=form.email %}
    {% include "usersec/form_field.html" with field=form.expiration %}
    {% include "usersec/form_field.html" with field=form.comment %}

    {% if update %}
      <a class="btn btn-secondary"
        {% if admin %}
          href="{% url 'adminsec:hpcusercreaterequest-detail' hpcusercreaterequest=object.uuid %}"
        {% else %}
          href="{% url 'usersec:hpcusercreaterequest-detail' hpcusercreaterequest=object.uuid %}"
        {% endif %}
      >
        <i class="iconify" data-icon="mdi:arrow-left-bold"></i>
        Cancel
      </a>
    {% else %}
      <a class="btn btn-secondary"
          href="{% url 'home' %}"
      >
        Cancel
      </a>
    {% endif %}
    <button class="btn btn-primary" type="submit">
      {% if update %}
        {% if admin %}
          Request Revision
        {% else %}
          Update
        {% endif %}
      {% else %}
        Submit
      {% endif %}
    </button>
  </form>

{% endblock content %}
